<!DOCTYPE html>
<html>
    <head>
        <title>Login / Registrieren</title>
        <meta charset="UTF-8">
       
    </head>
    <body>
        <h1>Login / Registrieren</h1>
        <b>Geben sie ihren Benutzernamen ein</b>
        <br>
        <input id="userName"  type="text" required>
        <br>
        <b>Geben sie ihr Passwort ein</b>
        <br>
        <input id="passWord" type="text" required>
        <br>
        <input type="button" id="login_button" value="Einloggen" onclick="login_click()">
        <br>
        <input type="button" id="reg_button" value="Registrieren" onclick="reg_click()">
    </body>
    <script>
        var userName, passWord;
        function login_click() {
            var userName = document.getElementById("userName").value;
            var passWord = document.getElementById("passWord").value;
            var data ={
                UserName: userName,
                User_pass: passWord
            }

            var url = `api/user?UserName=${encodeURIComponent(userName)}&User_pass=${encodeURIComponent(passWord)}`;

            fetch(url, {
                method: "GET",
                headers: {
                "Content-Type": "application/json"
            }
            })
            .then(response => {
                if (response.ok) {
                    alert("Benutzer wurde gefunden");
                    window.location.href = "/index";
                } else {
                    alert("Fehler beim Suchen");
                }
            })
            .catch(error => {
                alert("Fehler entdeckt: " + error);
            });
        }

        function reg_click(){
            userName = document.getElementById("userName").value;
            passWord = document.getElementById("passWord").value;
            if(userName == "" || passWord == ""){
                alert("Die Textfelder dürfen nicht Leer sein");
                return;
            }
            var data ={
                UserName: userName,
                User_pass: passWord
            }
            fetch("api/user",{
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(response =>{
                if(response.ok){
                    alert("User wurde Hinzugefügt");
                }
                else{
                    alert("Fehler beim Hinzufügen");
                }
            })
            .catch(error => {
                alert("Fehler entdeckt");
            });
        }
    </script>
</html>